-- Exploratory Data Analysis

select distinct category, subcategory from gold.dim_products

select 
min(order_date) as first_order_date,
max(order_date) as last_order_date,
timestampdiff(month, min(order_date), max(order_date)) as order_date_range
from gold.fact_sales

select 
timestampdiff(year, min(birth_date), now()) as oldest_age,
timestampdiff(year, max(birth_date), now()) as youngest_age
from gold.dim_customers

-- find the total sales
select sum(sales_amount) as total_sales from gold.fact_sales
-- find how many items sold
select sum(quantity) as total_quantity from gold.fact_sales
-- find the average selling price
select avg(price) as avg_price from gold.fact_sales
-- find the total number of orders
select count(order_number) as total_order from gold.fact_sales
select count(distinct order_number) as total_order from gold.fact_sales
-- find the total number of products
select count(product_key) as total_products from gold.dim_products
-- find the total number of customers
select count(customer_id) as total_customers from gold.dim_customers
-- find the total number of customers that has placed an order
select count( distinct customer_key) as total_customers from gold.fact_sales

-- generate a report that shows all key metrics of the business

select 'Total sales'      as measure_name, sum(sales_amount)            as measure_value from gold.fact_sales
union all
select 'Total quantity'   as measure_name, sum(quantity)                as measure_value from gold.fact_sales
union all
select 'Average price'    as measure_name, avg(price)                   as measure_value from gold.fact_sales
union all
select 'Total orders'     as measure_name, count(distinct order_number) as measure_value from gold.fact_sales
union all
select 'Total products'   as measure_name, count(product_key)           as measure_value from gold.dim_products
union all
select 'Total customers'  as measure_name, count(distinct customer_key) as measure_value from gold.fact_sales;
